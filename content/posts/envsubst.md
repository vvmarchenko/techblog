---
title: "ENVSUBST: —Å–ø—Ä–æ—â–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ –∑—ñ –∑–º—ñ–Ω–Ω–∏–º–∏ –æ—Ç–æ—á–µ–Ω–Ω—è –≤ –ø—Ä–æ–¥–∞–∫—à–Ω-—Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ"
date: 2023-05-15T21:04:15+03:00
summary: –ö–æ–º–∞–Ω–¥–∞ Linux 'envsubst', –ø—Ä–∏–∫–ª–∞–¥–∏ —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —É –ø—Ä–æ–¥–∞–∫—à–Ω.
description: –ö–æ–º–∞–Ω–¥–∞ Linux 'envsubst', –ø—Ä–∏–∫–ª–∞–¥–∏ —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —É –ø—Ä–æ–¥–∞–∫—à–Ω.
cover:
    image: /postsimg/envsubst.png
    relative: true
draft: false
author: "Vladyslav Marchenko"
---

## –í—Å—Ç—É–ø

–°—å–æ–≥–æ–¥–Ω—ñ —è —Ö–æ—Ç—ñ–≤ –±–∏ –ø–æ–¥—ñ–ª–∏—Ç–∏—Å—è –∑ –≤–∞–º–∏ —Ü—ñ–∫–∞–≤–æ—é —ñ –∫–æ—Ä–∏—Å–Ω–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ –∫–æ–º–∞–Ω–¥—É ***envsubst***.\
–Ø–∫—â–æ –≤–∏ –∫–æ–ª–∏-–Ω–µ–±—É–¥—å —Å—Ç–∏–∫–∞–ª–∏—Å—è –∑ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ—Å—Ç—é –∑–∞–º—ñ–Ω–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É —Ñ–∞–π–ª—ñ –∞–±–æ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó, —Ç–æ, –º–æ–∂–ª–∏–≤–æ, –∑–Ω–∞–π–æ–º—ñ –∑ —Ü—ñ—î—é –∫–æ–º–∞–Ω–¥–æ—é. –ê–ª–µ —è–∫—â–æ –Ω—ñ, —Ç–æ —Ü—è —Å—Ç–∞—Ç—Ç—è –±—É–¥–µ –∫–æ—Ä–∏—Å–Ω–æ—é –¥–ª—è –≤–∞—Å! –ú–∏ —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ, —â–æ —Ç–∞–∫–µ –∫–æ–º–∞–Ω–¥–∞ ***envsubst***, —è–∫ —ó—ó –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ —è–∫—ñ —î —ó—ó –∫–æ—Ä–∏—Å–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó.\
–¢–æ–∂, –ø–æ—á–Ω–µ–º–æ!üöÄ

## –©–æ —Ç–∞–∫–µ envsubst?

–ö–æ–º–∞–Ω–¥–∞ ***envsubst*** —î —É—Ç–∏–ª—ñ—Ç–æ—é –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –∑–∞–º—ñ–Ω—è—Ç–∏ –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ —É —Ç–µ–∫—Å—Ç–æ–≤–∏—Ö —Ñ–∞–π–ª–∞—Ö.\
–í–æ–Ω–∞ –∑—á–∏—Ç—É—î –≤—Ö—ñ–¥–Ω–∏–π –ø–æ—Ç—ñ–∫ –¥–∞–Ω–∏—Ö, —à—É–∫–∞—î –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ —É —Ñ–æ—Ä–º–∞—Ç—ñ **${VAR}** —Ç–∞ –∑–∞–º—ñ–Ω—é—î —ó—Ö –∑–Ω–∞—á–µ–Ω–Ω—è–º –∑–º—ñ–Ω–Ω–∏—Ö, —è–∫—ñ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ —É –ø–æ—Ç–æ—á–Ω–æ–º—É —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ. –†–µ–∑—É–ª—å—Ç–∞—Ç –≤–∏–≤–æ–¥–∏—Ç—å—Å—è –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π –≤–∏—Ö—ñ–¥–Ω–∏–π –ø–æ—Ç—ñ–∫.\
–ö–æ–º–∞–Ω–¥–∞ envsubst —î —á–∞—Å—Ç–∏–Ω–æ—é –ø–∞–∫–µ—Ç—É ***["gettext"](https://uk.wikipedia.org/wiki/Gettext)*** —Ç–∞ –ø–æ—Å—Ç–∞—á–∞—î—Ç—å—Å—è –∑ –±—ñ–ª—å—à—ñ—Å—Ç—é –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤—ñ–≤ Linux.

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è envsubst –∑ —Ñ–∞–π–ª–∞–º–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó Nginx

–î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó —Ä–æ–±–æ—Ç–∏ ***envsubst*** —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ –ø—Ä–∏–∫–ª–∞–¥ –∑ —Ñ–∞–π–ª–æ–º –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó Nginx.\
–ü—Ä–∏–ø—É—Å—Ç–∏–º–æ, –º–∏ –º–∞—î–º–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ñ–∞–π–ª `nginx.conf`, —è–∫–∏–π –º—ñ—Å—Ç–∏—Ç—å –∑–º—ñ–Ω–Ω—É **$SERVER_NAME**:
```bash
server {
    listen 80;
    server_name $SERVER_NAME;
    root /var/www/$SERVER_NAME;
    ...
}
```
\
–©–æ–± –∑–∞–º—ñ–Ω–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–º—ñ–Ω–Ω–æ—ó **$SERVER_NAME** –∑ –æ—Ç–æ—á–µ–Ω–Ω—è, –º–∏ –º–æ–∂–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –∫–æ–º–∞–Ω–¥—É ***envsubst***.\
–ü–µ—Ä—à –Ω—ñ–∂ —Ü–µ –∑—Ä–æ–±–∏—Ç–∏, –º–∏ –ø–æ–≤–∏–Ω–Ω—ñ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–º—ñ–Ω–Ω–æ—ó –æ—Ç–æ—á–µ–Ω–Ω—è **$SERVER_NAME**. –ù–∞–ø—Ä–∏–∫–ª–∞–¥ ***example.com***:
```bash
export SERVER_NAME=example.com
```
\
–¢–µ–ø–µ—Ä, –∑–∞—Å—Ç–æ—Å—É—î–º–æ –∫–æ–º–∞–Ω–¥—É ***envsubst*** –¥–æ —Ñ–∞–π–ª—É `nginx.conf`:
```s
envsubst < nginx.conf > nginx_generated.conf
```
\
–Ø–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —É –Ω–∞—Å –∑'—è–≤–∏—Ç—å—Å—è –Ω–æ–≤–∏–π —Ñ–∞–π–ª `nginx_generated.conf`, –¥–µ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–º—ñ–Ω–Ω–æ—ó **$SERVER_NAME** –±—É–¥–µ –∑–∞–º—ñ–Ω–µ–Ω–æ –Ω–∞ ***example.com***:

```bash
server {
    listen 80;
    server_name example.com;
    root /var/www/example.com;
    ...
}
```   
\
–¶–µ–π –Ω–æ–≤–∏–π —Ñ–∞–π–ª `nginx_generated.conf` –≤–∂–µ –º—ñ—Å—Ç–∏—Ç—å –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é, –∑–∞–º—ñ–Ω–µ–Ω—É –Ω–∞—à–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ –∑–º—ñ–Ω–Ω–∏—Ö –æ—Ç–æ—á–µ–Ω–Ω—è.\
–ô–æ–≥–æ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –¥–ª—è –∑–∞–ø—É—Å–∫—É **Nginx** –∑ –æ–Ω–æ–≤–ª–µ–Ω–æ—é –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—î—é.

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ –ø—Ä–æ–¥–∞–∫—à–Ω—ñ

–û–¥–Ω—ñ—î—é –∑ –æ—Å–Ω–æ–≤–Ω–∏—Ö –ø–µ—Ä–µ–≤–∞–≥ ***envsubst*** —î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ó—ó —É —Å—Ü–µ–Ω–∞—Ä—ñ—è—Ö –ø—Ä–æ–¥–∞–∫—à–Ω-—Å–µ—Ä–µ–¥–æ–≤–∏—â.\
–í–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –∑–º—ñ–Ω–Ω—ñ –æ—Ç–æ—á–µ–Ω–Ω—è –Ω–∞ —Å–≤–æ—î–º—É —Å–µ—Ä–≤–µ—Ä—ñ –∞–±–æ –≤ —Å–∏—Å—Ç–µ–º—ñ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—î—é, —Ç–∞–∫—ñ —è–∫ ***Kubernetes*** –∞–±–æ ***Docker Compose***, —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ ***envsubst*** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ—ó –∑–∞–º—ñ–Ω–∏ —Ü–∏—Ö –∑–Ω–∞—á–µ–Ω—å —É –≤–∞—à–æ–º—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–æ–º—É —Ñ–∞–π–ª—ñ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –ø—Ä–æ–≥—Ä–∞–º–∏.

–¶–µ –¥–æ–∑–≤–æ–ª—è—î –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–æ—é —ñ –ª–µ–≥–∫–æ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö, —â–æ —Å–ø—Ä–æ—â—É—î —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è —Ç–∞ –∫–µ—Ä—É–≤–∞–Ω–Ω—è –≤–∞—à–∏–º–∏ –¥–æ–¥–∞—Ç–∫–∞–º–∏.

### –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è envsubst —É —Å—Ü–µ–Ω–∞—Ä—ñ—ó CI/CD –¥–ª—è –ø—Ä–æ–µ–∫—Ç—É:

–£ —Å—Ü–µ–Ω–∞—Ä—ñ—ó CI/CD –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ ***envsubst*** –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–Ω–∞—á–µ–Ω–Ω—è –∑–º—ñ–Ω–Ω–æ—ó –æ—Ç–æ—á–µ–Ω–Ω—è **${IMAGE_TAG}** —É —à–∞–±–ª–æ–Ω —Ñ–∞–π–ª—É Task Definition AWS.\
–†–æ–∑–≥–ª—è–Ω–µ–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç —Å—Ü–µ–Ω–∞—Ä—ñ—é:
```yaml
- name: Deploy to ECS
  env:
    IMAGE_TAG: ${{ github.sha }}
  run: |
    envsubst < .github/templates/task_definition.template > task_definition.json
    aws ecs register-task-definition --cli-input-json file://task_definition.json
```
\
–£ —Ü—å–æ–º—É —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ñ –º–∏ –ø–µ—Ä–µ–¥–∞—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è —Ö–µ—à–∞ –∫–æ–º–º—ñ—Ç—É GitHub —è–∫ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–º—ñ–Ω–Ω–æ—ó –æ—Ç–æ—á–µ–Ω–Ω—è **${IMAGE_TAG}**.\
–ü–æ—Ç—ñ–º –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ ***envsubst*** –¥–ª—è –∑–∞–º—ñ–Ω–∏ –∑–º—ñ–Ω–Ω–∏—Ö –æ—Ç–æ—á–µ–Ω–Ω—è —É —à–∞–±–ª–æ–Ω—ñ ["task_definition.template"](https://raw.githubusercontent.com/vvmarchenko/Conduit/main/conduit_backend/backend-taskdef.template?token=GHSAT0AAAAAAB6SIPSHXBSJJ6AMZHW3J4ZUZDJ7T6Q) —Ç–∞ –∑–±–µ—Ä—ñ–≥–∞—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É —Ñ–∞–π–ª `task_definition.json`. –ù–∞—Ä–µ—à—Ç—ñ, –º–∏ —Ä–µ—î—Å—Ç—Ä—É—î–º–æ –æ–Ω–æ–≤–ª–µ–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è AWS –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–æ–º–∞–Ω–¥–∏ ***aws ecs register-task-definition***.

–ü–æ–≤–Ω–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π CI/CD –≤–∏ –º–æ–∂–µ—Ç–µ —Ä–æ–∑–≥–ª—è–Ω—É—Ç–∏ —É –º–æ—î–º—É [GitHub](https://github.com/vvmarchenko/Conduit).

## –ó–∞–∫–ª—é—á–µ–Ω–Ω—è:
–ö–æ–º–∞–Ω–¥–∞ ***envsubst*** —î –ø–æ—Ç—É–∂–Ω–∏–º —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º –¥–ª—è –∑–∞–º—ñ–Ω–∏ –∑–Ω–∞—á–µ–Ω—å –∑–º—ñ–Ω–Ω–∏—Ö –≤ —Ç–µ–∫—Å—Ç–æ–≤–∏—Ö —Ñ–∞–π–ª–∞—Ö.\
–í–æ–Ω–∞ –ø–æ–ª–µ–≥—à—É—î –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—é —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫—ñ–≤ —à–ª—è—Ö–æ–º –¥–∏–Ω–∞–º—ñ—á–Ω–æ—ó –∑–∞–º—ñ–Ω–∏ –¥–∞–Ω–∏—Ö. –ó–∞ –¥–æ–ø–æ–º–æ–≥–æ—é ***envsubst*** –≤–∏ –º–æ–∂–µ—Ç–µ –ª–µ–≥–∫–æ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –≥–Ω—É—á–∫—ñ —à–∞–±–ª–æ–Ω–∏ —Ç–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω—ñ —Ñ–∞–π–ª–∏.\
–ù–µ —Å–æ—Ä–æ–º—Ç–µ—Å—è –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É–≤–∞—Ç–∏ —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ ***envsubst*** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó –≤–∞—à–æ–≥–æ —Ä–æ–±–æ—á–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É.

–°–ø–æ–¥—ñ–≤–∞—é—Å—å, —â–æ —Ü—è —Å—Ç–∞—Ç—Ç—è –±—É–ª–∞ –∫–æ—Ä–∏—Å–Ω–æ—é –¥–ª—è –≤–∞—Å —ñ –Ω–∞–¥–∞–ª–∞ —á—ñ—Ç–∫—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ–º–∞–Ω–¥—É ***envsubst***. –í–æ–Ω–∞ –≤–∞—Ä—Ç–∞ —É–≤–∞–≥–∏ —É—Å—ñ—Ö, —Ö—Ç–æ –ø—Ä–∞—Ü—é—î –∑ Linux-—Å–µ—Ä–µ–¥–æ–≤–∏—â–µ–º —Ç–∞ —à—É–∫–∞—î –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ —Å–ø–æ—Å–æ–±–∏ –º–∞–Ω—ñ–ø—É–ª—è—Ü—ñ–π –∑ –∑–º—ñ–Ω–Ω–∏–º–∏ –≤ —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ.